<html>

  <head>
    <title>CodeChunk</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://unpkg.com/@stencila/thema@1/dist/themes/stencila/styles.css"
      rel="stylesheet">
    <script src="https://unpkg.com/@stencila/thema@1/dist/themes/stencila/index.js"
      type="text/javascript"></script>
    <script
      src="https://unpkg.com/@stencila/components@&lt;=1/dist/stencila-components/stencila-components.esm.js"
      type="module"></script>
    <script
      src="https://unpkg.com/@stencila/components@&lt;=1/dist/stencila-components/stencila-components.js"
      type="text/javascript"></script>
  </head>

  <body>
    <article itemscope="" itemtype="http://schema.org/Article">
      <div itemscope="" itemtype="http://schema.org/Organization" itemprop="publisher">
        <meta itemprop="name" content="Unknown">
        <div itemscope="" itemtype="http://schema.org/ImageObject" itemprop="logo">
          <meta itemprop="url"
            content="https://via.placeholder.com/600x60/dbdbdb/4a4a4a.png?text=Unknown"
            src="https://via.placeholder.com/600x60/dbdbdb/4a4a4a.png?text=Unknown">
        </div>
      </div>
      <h1 itemprop="headline">CodeChunk</h1>
      <meta itemprop="image"
        content="https://via.placeholder.com/1200x714/dbdbdb/4a4a4a.png?text=CodeChunk">
      <h1 itemscope="" itemtype="http://schema.stenci.la/Heading" id="structure">Structure</h1>
      <h2 itemscope="" itemtype="http://schema.stenci.la/Heading" id="source-properties">Source
        properties</h2>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">A <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code> has two &#39;source&#39;
        properties, <code itemscope="" itemtype="http://schema.stenci.la/CodeFragment">text</code>
        and <code itemscope="" itemtype="http://schema.stenci.la/CodeFragment">language</code>, from
        which it&#39;s other properties are derived during compilation (e.g. <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">import</code>, <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">declares</code>) or execution (e.g. <code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">outputs</code>).</p>
      <h3 itemscope="" itemtype="http://schema.stenci.la/Heading"
        id="textcodefragment-and-languagecodefragment"><code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">text</code> and <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">language</code></h3>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">All <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code>s are required to have a
        <code itemscope="" itemtype="http://schema.stenci.la/CodeFragment">text</code> property,
        containing the actual code, and most will also specify the programming <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">language</code>. If <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">language</code> is not specified then it
        defaults to the language of the previous <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code> or <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">CodeExpression</code> in the document. So,
        if you are writing a document that only uses one language, you only need to <code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">For more on these properties
          see [</code>Code`](./Code.html).</p>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">An example of a simple <code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code>,</p>
      <pre data-import="helloWorld" itemscope="" itemtype="http://schema.stenci.la/CodeBlock"><code class="language-json" itemscope="" itemtype="http://schema.stenci.la/CodeFragment">{
  &quot;type&quot;: &quot;CodeChunk&quot;,
  &quot;language&quot;: &quot;python&quot;,
  &quot;text&quot;: &quot;print(&#39;Hello world&#39;)&quot;
}</code></pre>
      <h2 itemscope="" itemtype="http://schema.stenci.la/Heading" id="compilation-properties">
        Compilation properties</h2>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">The following properties of a
        <code itemscope="" itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code> are
        populated during compilation. You can also override the compiler and specify them manually.
      </p>
      <h3 itemscope="" itemtype="http://schema.stenci.la/Heading" id="importscodefragment"><code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">imports</code></h3>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">The <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">imports</code> property lists the packages
        that a <code itemscope="" itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code>
        imports into the execution context. It is used by the compiler to populate the <code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">requires</code> property of
        the document containing the chunk so that it can build an execution environment for it (e.g.
        a Docker container).</p>
      <ul itemscope="" itemtype="http://schema.org/ItemList">
        <li itemscope="" itemtype="http://schema.org/ListItem">
          <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">dokta regex style</p>
        </li>
        <li itemscope="" itemtype="http://schema.org/ListItem">
          <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">AST walking</p>
        </li>
      </ul>
      <pre data-import="importPython" itemscope="" itemtype="http://schema.stenci.la/CodeBlock"><code class="language-json" itemscope="" itemtype="http://schema.stenci.la/CodeFragment">{
  &quot;type&quot;: &quot;CodeChunk&quot;,
  &quot;language&quot;: &quot;python&quot;,
  &quot;text&quot;: &quot;import matplotlib&quot;
}</code></pre>
      <pre data-import="importJavascript" itemscope="" itemtype="http://schema.stenci.la/CodeBlock"><code class="language-yaml" itemscope="" itemtype="http://schema.stenci.la/CodeFragment">type: CodeChunk
language: javascript
text: |
  import * as d3 from &#39;d3&#39;
  const kmeans = require(&#39;ml-kmeans&#39;);
imports:
  - d3
  - ml-kmeans</code></pre>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">You can manually add packages to
        the <code itemscope="" itemtype="http://schema.stenci.la/CodeFragment">imports</code>
        property of a <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code>. When the chunk is
        compiled, only missing packages are added to required. If for some reason you want full
        control and do not want the compiler to add anything to <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">imports</code>, set the first value to the
        empty string.</p>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">For example, in R you can call a
        function in a package without first importing via a call to <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">library</code>:</p>
      <pre data-import="importJavascript" itemscope="" itemtype="http://schema.stenci.la/CodeBlock"><code class="language-yaml" itemscope="" itemtype="http://schema.stenci.la/CodeFragment">type: CodeChunk
language: r
text: |
  superdoopa::func(&quot;beep&quot;, &quot;boop&quot;)
imports:
  - &#39;&#39;
  - superdoopa</code></pre>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph"><a href="" itemscope=""
          itemtype="http://schema.stenci.la/Link">//</a> TODO: Reallife example with dplyr or
        something</p>
      <h3 itemscope="" itemtype="http://schema.stenci.la/Heading" id="declarescodefragment"><code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">declares</code></h3>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">The <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">declares</code> property lists the
        variables that a <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code> declares. It is used by
        the compiler to build a graph of the dependencies among <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code>s and <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">CodeExpressions</code>. This in turn
        allows for reactivity. When a user changes a chunk containing a declaration, all of the
        other chunks or expressions that use that variable will be re-executed.</p>
      <pre data-import="pythonFunction" itemscope="" itemtype="http://schema.stenci.la/CodeBlock"><code class="language-yaml" itemscope="" itemtype="http://schema.stenci.la/CodeFragment">type: CodeChunk
language: python
text: |
  def greet(who: str):
    return &#39;Hello %s!&#39; % who
declares:
  - type: Function
    name: greet
    parameters:
      - type: Parameter
        name: who
        schema:
          - type: StringSchema</code></pre>
      <h3 itemscope="" itemtype="http://schema.stenci.la/Heading" id="code-comment-overrides">Code
        comment overrides</h3>
      <h4 itemscope="" itemtype="http://schema.stenci.la/Heading" id="r">R</h4>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">In R code chunk properties can be
        specified using the <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">@property</code> tags in comments:</p>
      <pre itemscope="" itemtype="http://schema.stenci.la/CodeBlock"><code class="language-r" itemscope="" itemtype="http://schema.stenci.la/CodeFragment">#&#39; @imports package1, package2
#&#39; @uses variable1, variable2
#&#39; @declares variable3, variable4
#&#39; @alters variable5, variable6</code></pre>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">One situation in R where you may
        want to use a comment override is to enable reactivity for a chunk that uses a function with
        <a href="http://adv-r.had.co.nz/Computing-on-the-language.html" itemscope=""
          itemtype="http://schema.stenci.la/Link">non-standard evaluation</a>, for example <code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">subset</code>, or many of the
        functions in the <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">tidyverse</code>. The Stencila R compiler
        ignores some of the arguments supplied to these functions because of the peculiar scoping
        rules. e.g.</p>
      <pre itemscope="" itemtype="http://schema.stenci.la/CodeBlock"><code class="language-r" itemscope="" itemtype="http://schema.stenci.la/CodeFragment">#&#39; @uses begin, end
data &lt;- subset(all_data, year &gt;= begin &amp;&amp; year &lt;= end)</code></pre>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">See <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">stencila::nse_funcs</code> for a list of
        registered NSE functions.</p>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">Another situation is where you
        have a function that reads files from the file system but is not one of the registered
        &quot;readers&quot; (see <code itemscope=""
          itemtype="http://schema.stenci.la/CodeFragment">stencila::reader_funcs</code> for a list
        of registered reader functions). In this case, supply a comma separated list of the files
        read e.g.</p>
      <pre itemscope=""
        itemtype="http://schema.stenci.la/CodeBlock"><code class="language-r" itemscope="" itemtype="http://schema.stenci.la/CodeFragment">#&#39; @reads ./data/all.csv, ./data/categories.csv
all_data &lt;- special_read_csv(&#39;./data/all.csv&#39;, &#39;./data/categories.csv&#39;)</code></pre>
      <h2 itemscope="" itemtype="http://schema.stenci.la/Heading" id="execution-properties">
        Execution properties</h2>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">The following properties of a
        <code itemscope="" itemtype="http://schema.stenci.la/CodeFragment">CodeChunk</code> are
        populated during execution.</p>
      <h2 itemscope="" itemtype="http://schema.stenci.la/Heading" id="outputscodefragment"><code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">outputs</code></h2>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph">When a code chunk is executed...
      </p>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph"><a href="" itemscope=""
          itemtype="http://schema.stenci.la/Link">//</a> TODO:</p>
      <h2 itemscope="" itemtype="http://schema.stenci.la/Heading" id="errorscodefragment"><code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">errors</code></h2>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph"><a href="" itemscope=""
          itemtype="http://schema.stenci.la/Link">//</a> TODO:</p>
      <h2 itemscope="" itemtype="http://schema.stenci.la/Heading" id="durationcodefragment"><code
          itemscope="" itemtype="http://schema.stenci.la/CodeFragment">duration</code></h2>
      <p itemscope="" itemtype="http://schema.stenci.la/Paragraph"><a href="" itemscope=""
          itemtype="http://schema.stenci.la/Link">//</a> TODO:</p>
    </article>
  </body>

</html>